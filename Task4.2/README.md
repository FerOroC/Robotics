Improved version of Task 4.
